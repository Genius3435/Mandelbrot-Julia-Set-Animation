extern crate minifb;use minifb::*;fn main(){let s=720;let(mut f,t)=(vec![0;2*s*s],|x,y|(x as f64/225.-1.6,y as f64/225.-1.6));for x in 0..s{for y in 0..s{let(p,q)=t(y,x);let(mut z,mut i)=((p,q),0);while i<255{let(a,b)=z;if a*a+b*b>4.{break;}z=(a*a-b*b+p as f64,2.*a*b+q as f64);i+=5;}let d=s-x.max(y);f[x*2*s+y]=(((x+d)as f64/4.)as u32)<<16|i<<8|((y+d)as f64/4.)as u32;}}let mut w=Window::new("Mandelbrot/Julia Sets",2*s,s,WindowOptions::default()).unwrap();w.limit_update_rate(Some(std::time::Duration::from_millis(33)));let mut c=(0.,0.);while w.is_open(){if!w.is_key_down(Key::Space){w.get_mouse_pos(MouseMode::Discard).map(|(x,y)|{if x<720.{c=t(x as usize,y as usize);}});for x in 0..s{for y in 0..s{let(mut z,mut i)=(t(x,y),0);while i<255&&z.0*z.0+z.1*z.1<=4.{let(a,b)=z;z=(a*a-b*b+c.0,2.*a*b+c.1);i+=5;}let d=s-x.max(y);f[y*2*s+x+s]=(((x+d)as f64/4.)as u32)<<16|i<<8|((y+d)as f64/4.)as u32;}}}w.update_with_buffer(&f,2*s,s).unwrap();}}